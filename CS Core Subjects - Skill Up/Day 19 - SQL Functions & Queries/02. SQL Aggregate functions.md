# **Day 19 - SQL Functions & Queries: Aggregate Functions**

SQL Aggregate Functions are used to **perform calculations on a set of rows** and return a **single summary value**. They are mainly used for **summarizing, analyzing, or grouping data**.

---

## **1. Key Features of Aggregate Functions**

* **Operate on groups of rows:** Works on multiple rows and returns one value.
* **Ignore NULLs:** Most functions ignore NULLs except `COUNT(*)`.
* **Used with `GROUP BY`:** To summarize data for each group.
* **Combine with other clauses:** Can be used with `HAVING`, `ORDER BY`, and `WHERE`.

---

## **2. Common Aggregate Functions**

### **a) COUNT()**

Counts rows or non-NULL values in a column.

| Usage                         | Description                       | Example                                                          |
| ----------------------------- | --------------------------------- | ---------------------------------------------------------------- |
| `COUNT(*)`                    | Counts **all rows**               | `SELECT COUNT(*) AS TotalRecords FROM Employee;`                 |
| `COUNT(column_name)`          | Counts **non-NULL values**        | `SELECT COUNT(Salary) AS NonNullSalaries FROM Employee;`         |
| `COUNT(DISTINCT column_name)` | Counts **unique non-NULL values** | `SELECT COUNT(DISTINCT Salary) AS UniqueSalaries FROM Employee;` |

**Example Table: Employee**

| Id | Name | Salary |
| -- | ---- | ------ |
| 1  | A    | 802    |
| 2  | B    | 403    |
| 3  | C    | 604    |
| 4  | D    | 705    |
| 5  | E    | 606    |
| 6  | F    | NULL   |

```sql
-- Total Employees
SELECT COUNT(*) AS TotalEmployees FROM Employee;
```

**Output:** 6

---

### **b) SUM()**

Calculates the **total of numeric column values**. Ignores NULLs.

```sql
-- Total Salary
SELECT SUM(Salary) AS TotalSalary FROM Employee;
```

**Output:** 3120

```sql
-- Sum of distinct salaries
SELECT SUM(DISTINCT Salary) AS DistinctSalarySum FROM Employee;
```

**Explanation:** Adds up values in the Salary column. Distinct ensures repeated salaries are counted once.

---

### **c) AVG()**

Calculates the **average of numeric column values**. Ignores NULLs.

```sql
-- Average Salary
SELECT AVG(Salary) AS AverageSalary FROM Employee;
```

**Output:** 624

```sql
-- Average of distinct salaries
SELECT AVG(DISTINCT Salary) AS DistinctAvgSalary FROM Employee;
```

---

### **d) MIN() and MAX()**

Returns the **smallest** or **largest** value from a column.

```sql
-- Highest Salary
SELECT MAX(Salary) AS HighestSalary FROM Employee;

-- Lowest Salary
SELECT MIN(Salary) AS LowestSalary FROM Employee;
```

**Output Highest:** 802
**Output Lowest:** 403

---

## **3. Using Aggregate Functions with GROUP BY**

**Purpose:** Summarize data **per group** instead of the entire table.

**Example:** Total salary per department

```sql
SELECT department, SUM(Salary) AS TotalSalary
FROM Employee
GROUP BY department;
```

**Explanation:**

* `GROUP BY department` groups rows with the same department.
* `SUM(Salary)` calculates total salary for each group.

**Other Clauses Often Used:**

* `HAVING` → Filter **groups** after aggregation (like WHERE for individual rows)
* `ORDER BY` → Sort results based on aggregated values

```sql
SELECT department, AVG(Salary) AS AvgSalary
FROM Employee
GROUP BY department
HAVING AVG(Salary) > 500
ORDER BY AvgSalary DESC;
```

---

## **4. Summary Table**

| Function            | Purpose                   | Ignores NULL? | Example                                        |
| ------------------- | ------------------------- | ------------- | ---------------------------------------------- |
| COUNT(*)            | Count rows                | No            | `SELECT COUNT(*) FROM Employee;`               |
| COUNT(col)          | Count non-NULL values     | Yes           | `SELECT COUNT(Salary) FROM Employee;`          |
| COUNT(DISTINCT col) | Count unique non-NULL     | Yes           | `SELECT COUNT(DISTINCT Salary) FROM Employee;` |
| SUM(col)            | Sum of numeric values     | Yes           | `SELECT SUM(Salary) FROM Employee;`            |
| AVG(col)            | Average of numeric values | Yes           | `SELECT AVG(Salary) FROM Employee;`            |
| MIN(col)            | Smallest value            | Yes           | `SELECT MIN(Salary) FROM Employee;`            |
| MAX(col)            | Largest value             | Yes           | `SELECT MAX(Salary) FROM Employee;`            |

---

### ✅ **Key Takeaways**

1. Aggregate functions summarize multiple rows into a single value.
2. `COUNT(*)` includes NULLs, others ignore NULLs.
3. Use `GROUP BY` to summarize per category.
4. Use `HAVING` to filter **aggregated results**.
5. Can combine with `ORDER BY` to sort summaries.
