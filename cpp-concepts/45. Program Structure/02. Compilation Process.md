# **C++ Compilation Process**

The **C++ compilation process** converts human-readable C++ code into an executable machine program. It involves multiple stages, each crucial for correct execution.

---

## **Steps Involved in Compilation**

1. **Source Code**

   * Programmer-written C++ code (`.cpp`, `.h` files).
   * `.cpp` → function definitions & `main()`
   * `.h` → function declarations or constants (headers)

**Example:**

```cpp
// main.cpp
#include <iostream>
#include "math_utils.h"

int main() {
    int result = add(10, 5);
    std::cout << "Result: " << result << std::endl;
    return 0;
}
```

---

2. **Preprocessing**

   * Handles lines starting with `#` (`#include`, `#define`, etc.)
   * Tasks:

     * Replace `#include` with actual code
     * Expand macros
     * Handle conditional compilation (`#ifdef`, etc.)

**Command:**

```
g++ -E main.cpp -o main.i
```

**Output (`main.i`):** Preprocessed C++ code with all headers included.

**Example:**

```cpp
#include <iostream>  // contents of iostream inserted
#include "math_utils.h"  // int add(int a, int b);
```

---

3. **Compilation**

   * Translates preprocessed C++ code → **assembly language** (.s file)
   * Performs syntax checking

**Command:**

```
g++ -S main.i -o main.s
```

**Example:**

```cpp
int result = add(10, 5);
```

Assembly:

```
movl $10, -4(%rbp)
movl $5, -8(%rbp)
call add
```

---

4. **Assembly**

   * Converts assembly code → **object code** (.o file)
   * Machine-readable but **not executable**

**Command:**

```
g++ -c main.cpp -o main.o
```

**Output:** `.o` file containing machine code.

---

5. **Linking**

   * Combines multiple object files and external libraries to create executable
   * Resolves symbols and connects functions

**Command:**

```
g++ main.o math_utils.o -o main
```

**Output:** Executable file (`main`)

---

6. **Execution**

   * Runs the final executable

**Command:**

```
./main
```

**Output:**

```
Result: 15
```

---

## **Tools Involved**

| Stage         | Tool   | Example Command            |
| ------------- | ------ | -------------------------- |
| Preprocessing | g++ -E | g++ -E main.cpp -o main.i  |
| Compilation   | g++ -S | g++ -S main.i -o main.s    |
| Assembly      | g++ -c | g++ -c main.s -o main.o    |
| Linking       | g++    | g++ main.o -o main         |
| Automation    | make   | Automate multi-file builds |

---

## **Common Errors at Each Stage**

| Stage         | Common Errors                         |
| ------------- | ------------------------------------- |
| Preprocessing | Header not found, macro errors        |
| Compilation   | Syntax errors, type mismatches        |
| Assembly      | Rare, architecture-specific errors    |
| Linking       | Undefined references, missing symbols |
| Execution     | Segmentation faults, logic bugs       |

---

**Key Notes:**

* C++ compilation is a **multi-stage pipeline**: Source → Preprocess → Compile → Assemble → Link → Execute
* Understanding this process helps **debug errors** efficiently and manage **multi-file projects**
