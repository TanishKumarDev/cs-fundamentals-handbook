# **Advanced Pointers in C++**

## **Topic 3: Function Pointers and Callbacks**

---

## **1. What is a Function Pointer?**

A **function pointer** is a pointer that stores the **address of a function** instead of a variable.

Just like a normal pointer points to data, a function pointer points to code (the function body in memory).

**Why use function pointers?**

1. Call functions dynamically (indirectly).
2. Implement **callbacks**.
3. Store multiple functions in an array for **dynamic dispatch**.
4. Reduce repeated code by passing behavior as an argument.

---

## **2. Syntax of Function Pointer**

If you have a function:

```cpp
int foo(char c);
```

Then the **function pointer declaration** is:

```cpp
int (*func_ptr)(char) = &foo;
```

* `int` → return type of the function.
* `(*func_ptr)` → name of the function pointer.
* `(char)` → parameter types of the function.

**Important Notes:**

* You can use **just the function name** instead of `&foo`:

```cpp
int (*func_ptr)(char) = foo;  // also valid
```

* Calling the function via the pointer:

```cpp
int result = func_ptr('a');   // same as foo('a')
```

---

## **3. How Function Pointers Work**

Function pointers store the **memory address of the function**.
When you call via the pointer, the CPU jumps to that address and executes the function code.

### **Diagram of Flow**

```
foo(char)         func_ptr
   |                 |
   +----------------> stores address of foo
```

Calling `func_ptr('a')` → executes `foo('a')`.

---

## **4. Function Pointer as a Callback**

A **callback** is a function that you **pass as an argument** to another function.

* The caller does not know **which exact function** will be executed.
* The callee uses the function pointer to invoke it.

---

### **Example: Callback in C++**

```cpp
#include <iostream>
using namespace std;

// Callback function
int foo(char c) {
    return (int)c;  // return ASCII code of character
}

// Function that takes a callback
void printASCIIcode(char c, int (*func_ptr)(char)) {
    int ascii = func_ptr(c);  // call function via pointer
    cout << "ASCII code of " << c << " is: " << ascii << endl;
}

// Driver code
int main() {
    printASCIIcode('a', foo);  // pass function as argument
    return 0;
}
```

**Output:**

```
ASCII code of a is: 97
```

**Explanation:**

1. `foo()` is the callback function.
2. `printASCIIcode()` accepts a function pointer `int(*func_ptr)(char)`.
3. Inside `printASCIIcode`, we call `func_ptr(c)`, which executes `foo(c)`.

---

## **5. Why `foo` or `&foo` Works**

In C++, the **function name without parentheses decays to a pointer** automatically.

```cpp
func_ptr = foo;   // automatically treated as &foo
func_ptr = &foo;  // explicit
```

* Both are valid and equivalent.
* Using `&` is optional; it makes the code clearer but not required.

---

## **6. Array of Function Pointers**

Function pointers can be stored in **arrays** to dynamically call different functions:

```cpp
#include <iostream>
using namespace std;

int add(int a, int b) { return a + b; }
int sub(int a, int b) { return a - b; }

int main() {
    int (*operations[2])(int,int) = { add, sub }; // array of function pointers

    cout << "Add: " << operations[0](5, 3) << endl;  // calls add
    cout << "Sub: " << operations[1](5, 3) << endl;  // calls sub

    return 0;
}
```

**Output:**

```
Add: 8
Sub: 2
```

**Use Case:** Dynamic behavior, plugins, command processing, menu-driven programs.

---

## **7. Advantages of Function Pointers**

1. **Dynamic execution:** Decide which function to execute at runtime.
2. **Callbacks:** Useful for library functions or event-driven programming.
3. **Reduce repetitive code:** Pass different behaviors to the same function.
4. **Arrays of functions:** Can implement jump tables, dynamic dispatch.

---

## **8. Precautions**

* Must match **function signature exactly** (return type and parameters).
* Do not call uninitialized function pointers — causes undefined behavior.
* Be careful with casting functions; avoid void pointer tricks here.

---

## **9. Summary Table**

| Feature      | Description                                            |
| ------------ | ------------------------------------------------------ |
| Pointer Type | Points to a function instead of data                   |
| Declaration  | `return_type (*ptr)(param_types)`                      |
| Calling      | `ptr(arguments)` or `(*ptr)(arguments)`                |
| Callback     | Pass pointer to another function for dynamic execution |
| Array        | Can store multiple function pointers                   |
| Notes        | Function name decays to pointer automatically          |


**Function pointers are the core of callbacks in C/C++, used heavily in APIs, event-driven code, and low-level libraries.**