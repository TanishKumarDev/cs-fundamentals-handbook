# **Day 11: Data Anomalies and Database Normalization**

## **1. Anomalies in the Relational Model**

### **Definition**

Anomalies in a relational database are **inconsistencies or errors** that occur during **insertion**, **deletion**, or **update** operations.
They arise due to **data redundancy**, **poor database design**, or **lack of normalization**, leading to compromised **data integrity**.

---

### **Causes of Anomalies**

1. Flat or unstructured database design
2. Redundant data
3. Improper use of **primary** and **foreign keys**
4. Absence of **normalization**

---

### **Types of Anomalies**

#### **1. Insertion Anomaly**

Occurs when you **cannot insert new data** without adding unwanted or incomplete information.

**Example:**
If we try to insert a record into `STUDENT_COURSE` with `STUD_NO = 7`,
but there is no student with `STUD_NO = 7` in the `STUDENT` table → insertion is **not allowed**.

This happens due to a **foreign key constraint** violation.

---

#### **2. Deletion Anomaly**

Occurs when deleting a record **unintentionally removes related data**.

**Example:**
Deleting a student from the `STUDENT` table with `STUD_NO = 1`
will also remove all their course details from `STUDENT_COURSE`.

This leads to **loss of valuable information**.

---

#### **3. Update Anomaly**

Occurs when a value is **updated in one place but not everywhere**, causing inconsistency.

**Example:**
If a student’s phone number is stored in multiple rows,
and we update it in only one record → inconsistent data.

---

### **How Foreign Key Constraints Handle Anomalies**

| Constraint Type               | Description                                                                                                       |
| ----------------------------- | ----------------------------------------------------------------------------------------------------------------- |
| **ON DELETE/UPDATE SET NULL** | If a referenced record is deleted or updated, the referencing value becomes **NULL**.                             |
| **ON DELETE/UPDATE CASCADE**  | If a referenced record is deleted or updated, the corresponding referencing records are also **deleted/updated**. |

These rules maintain **referential integrity** between related tables.

---

### **Example Schema**

**STUDENT Table**

| STUD_NO | STUD_NAME | STUD_PHONE | STUD_STATE | STUD_COUNTRY | STUD_AGE |
| ------- | --------- | ---------- | ---------- | ------------ | -------- |
| 1       | RAM       | 9716271721 | Haryana    | India        | 20       |
| 2       | RAM       | 9898291281 | Punjab     | India        | 19       |
| 3       | SUJIT     | 7898291981 | Rajasthan  | India        | 18       |
| 4       | SURESH    | (NULL)     | Punjab     | India        | 21       |

**STUDENT_COURSE Table**

| STUD_NO | COURSE_NO | COURSE_NAME       |
| ------- | --------- | ----------------- |
| 1       | C1        | DBMS              |
| 2       | C2        | Computer Networks |
| 1       | C2        | Computer Networks |

---

## **2. Removal of Anomalies Using Normalization**

### **Definition**

**Normalization** is the process of organizing data into well-structured tables to:

* Eliminate redundancy
* Maintain data integrity
* Prevent anomalies (insertion, update, deletion)

**Invented by:** *E. F. Codd*, the founder of the Relational Database Model.

---

### **Goals of Normalization**

1. Remove duplicate data
2. Eliminate insertion, update, and deletion anomalies
3. Establish meaningful relationships between tables
4. Improve storage efficiency and consistency

---

### **Normalization Steps**

| **Normal Form**              | **Rule**                                                                           | **Purpose**                                                  |
| ---------------------------- | ---------------------------------------------------------------------------------- | ------------------------------------------------------------ |
| **1NF (First Normal Form)**  | Each attribute must hold **atomic** (indivisible) values.                          | Removes **repeating groups** and **multivalued attributes**. |
| **2NF (Second Normal Form)** | Must be in 1NF and all non-key attributes **fully depend** on the **primary key**. | Removes **partial dependencies**.                            |
| **3NF (Third Normal Form)**  | Must be in 2NF and no non-key attribute depends on another non-key attribute.      | Removes **transitive dependencies**.                         |

---

### **Effect of Normalization**

* Reduces **data redundancy**
* Prevents **data anomalies**
* Improves **data consistency**
* Simplifies **database maintenance**

---

### **Summary**

| **Concept**               | **Description**                                    |
| ------------------------- | -------------------------------------------------- |
| **Anomalies**             | Inconsistencies during insert, update, or delete.  |
| **Causes**                | Redundancy, poor key usage, lack of normalization. |
| **Prevention**            | Apply normalization (1NF → 3NF).                   |
| **Integrity Maintenance** | Use foreign key constraints (SET NULL, CASCADE).   |

---