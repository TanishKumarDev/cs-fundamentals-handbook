# **Day 21 - SQL Views, Indexes, Cursors, Triggers**

## SQL Indexes

### **1. What is an Index?**

An **index** is a **special data structure** in SQL that improves **query performance** by allowing the database to **quickly locate rows** instead of scanning the entire table.

**Benefits:**

* Speeds up `SELECT`, `JOIN`, `WHERE`, `ORDER BY` queries.
* Reduces disk I/O for large tables.
* Maintains **data integrity** via unique indexes.

> ⚠️ Note: **Too many indexes** slow down `INSERT`, `UPDATE`, and `DELETE` operations.
> Primary key and unique constraints **automatically create indexes**.

---

### **2. Types of Indexes**

#### **2.1 Single Column Index**

Indexes one column to speed up queries on that column.

```sql
CREATE INDEX idx_product_id ON Sales (product_id);
```

**Example Table: Sales**

| sale_id | product_id | quantity | customer_id |
| ------- | ---------- | -------- | ----------- |
| 1       | 101        | 5        | 201         |
| 2       | 102        | 2        | 202         |
| 3       | 101        | 3        | 203         |
| 4       | 103        | 1        | 204         |
| 5       | 104        | 7        | 205         |

---

#### **2.2 Multi-Column Index**

Speeds up queries filtering/joining on **multiple columns**.

```sql
CREATE INDEX idx_product_quantity ON Sales (product_id, quantity);
```

---

#### **2.3 Unique Index**

Ensures **no duplicate values** in the column(s).

```sql
CREATE UNIQUE INDEX idx_unique_customer ON Sales (customer_id);
```

> Trying to insert a duplicate `customer_id` will throw an error.

```sql
INSERT INTO Sales (sale_id, product_id, quantity, customer_id)
VALUES (6, 105, 4, 201); -- Error, customer_id 201 exists
```

---

### **3. Removing an Index**

```sql
DROP INDEX idx_product_quantity;
```

> Deletes the index but keeps the table data intact.

---

### **4. Altering an Index**

```sql
ALTER INDEX idx_product_id ON Sales REBUILD;
```

> Optimizes the index structure for better performance.

---

### **5. Viewing Indexes**

```sql
SHOW INDEXES FROM Sales;
```

**Output Example:**

| Table | Non_unique | Key_name             | Column_name |
| ----- | ---------- | -------------------- | ----------- |
| Sales | 1          | idx_product_quantity | product_id  |
| Sales | 1          | idx_product_quantity | quantity    |
| Sales | 0          | idx_unique_customer  | customer_id |

---

### **6. Renaming an Index** *(SQL Server example)*

```sql
EXEC sp_rename 'idx_product_quantity', 'idx_prod_qty', 'INDEX';
```

> Useful for **clarity** or **schema maintenance**.

---

✅ **Quick Tips:**

* Use indexes on **columns frequently used in WHERE, JOIN, ORDER BY**.
* Avoid **over-indexing**, as it slows down writes.
* Unique indexes also enforce **data integrity**.
* Primary keys automatically create **unique indexes**.

---